Vocab size: 32,000
num_layers: 2
model_dim: 128
num_heads: 1
num_kv_heads: 1
Tokens / micro-batch / rank: 2 x 512 = 1,024
Tokens / micro-batch: 1,024
Total batch size 32,768 => gradient accumulation steps: 32
Number of parameters: 8,585,216
Estimated FLOPs per token: 2.850816e+07
Using user-provided number of iterations: 40
Total number of training tokens: 1,310,720
Tokens : Params ratio: 0.15
Total training FLOPs estimate: 3.736622e+13
Scaling the LR for the AdamW parameters ‚àù1/‚àö(128/768) = 2.449490
W1019 10:01:44.389000 23118 .venv/lib/python3.10/site-packages/torch/_inductor/utils.py:1436] [0/0] Not enough SMs to use max_autotune_gemm mode
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
Step 00000 | Validation bpb: 3.2725
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
step 00000/00040 (0.00%) | loss: 10.373490 | lrm: 1.00 | dt: 1466.95ms | tok/sec: 698 | mfu: 0.06 | total time: 0.00m
step 00001/00040 (2.50%) | loss: 10.347078 | lrm: 1.00 | dt: 822.10ms | tok/sec: 1,245 | mfu: 0.11 | total time: 0.00m
step 00002/00040 (5.00%) | loss: 10.125708 | lrm: 1.00 | dt: 835.93ms | tok/sec: 1,224 | mfu: 0.11 | total time: 0.00m
step 00003/00040 (7.50%) | loss: 9.840069 | lrm: 1.00 | dt: 880.82ms | tok/sec: 1,162 | mfu: 0.11 | total time: 0.00m
step 00004/00040 (10.00%) | loss: 9.537739 | lrm: 1.00 | dt: 838.56ms | tok/sec: 1,221 | mfu: 0.11 | total time: 0.00m
step 00005/00040 (12.50%) | loss: 9.252333 | lrm: 1.00 | dt: 839.20ms | tok/sec: 1,220 | mfu: 0.11 | total time: 0.00m
step 00006/00040 (15.00%) | loss: 9.067279 | lrm: 1.00 | dt: 840.52ms | tok/sec: 1,218 | mfu: 0.11 | total time: 0.00m
step 00007/00040 (17.50%) | loss: 8.901908 | lrm: 1.00 | dt: 862.89ms | tok/sec: 1,186 | mfu: 0.11 | total time: 0.00m
step 00008/00040 (20.00%) | loss: 8.779054 | lrm: 1.00 | dt: 841.95ms | tok/sec: 1,216 | mfu: 0.11 | total time: 0.00m
step 00009/00040 (22.50%) | loss: 8.685499 | lrm: 1.00 | dt: 843.27ms | tok/sec: 1,214 | mfu: 0.11 | total time: 0.00m
Step 00010 | Validation bpb: 2.5385
/content/nanochat/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:2509: UserWarning: Tesla T4 does not support bfloat16 compilation natively, skipping
  warnings.warn(
<|bos|>The capital of France is the the the the the the the the the the the the the the the the
<|bos|>The chemical symbol of gold is the the the the the the the the the the the the the the the the
<|bos|>If yesterday was Friday, then tomorrow will be the the the the the the the the the the the the the the the the
<|bos|>The opposite of hot is the the the the the the the the the the the the the the the the
<|bos|>The planets of the solar system are: the the the the the the the the the the the the the the the the
<|bos|>My favorite color is the the the the the the the the the the the the the the the the
<|bos|>If 5*x + 3 = 13, then x is the the the the the the the the the the the the the the the the
step 00010/00040 (25.00%) | loss: 8.611230 | lrm: 1.00 | dt: 861.64ms | tok/sec: 1,188 | mfu: 0.11 | total time: 0.00m
step 00011/00040 (27.50%) | loss: 8.526076 | lrm: 1.00 | dt: 845.47ms | tok/sec: 1,211 | mfu: 0.11 | total time: 0.01m
step 00012/00040 (30.00%) | loss: 8.444030 | lrm: 1.00 | dt: 845.04ms | tok/sec: 1,211 | mfu: 0.11 | total time: 0.03m
step 00013/00040 (32.50%) | loss: 8.423395 | lrm: 1.00 | dt: 943.84ms | tok/sec: 1,084 | mfu: 0.10 | total time: 0.04m
step 00014/00040 (35.00%) | loss: 8.346410 | lrm: 1.00 | dt: 868.64ms | tok/sec: 1,178 | mfu: 0.11 | total time: 0.06m
step 00015/00040 (37.50%) | loss: 8.305692 | lrm: 1.00 | dt: 844.09ms | tok/sec: 1,213 | mfu: 0.11 | total time: 0.07m
step 00016/00040 (40.00%) | loss: 8.235786 | lrm: 1.00 | dt: 866.41ms | tok/sec: 1,181 | mfu: 0.11 | total time: 0.09m
step 00017/00040 (42.50%) | loss: 8.200747 | lrm: 1.00 | dt: 843.21ms | tok/sec: 1,214 | mfu: 0.11 | total time: 0.10m
step 00018/00040 (45.00%) | loss: 8.159801 | lrm: 1.00 | dt: 842.63ms | tok/sec: 1,215 | mfu: 0.11 | total time: 0.11m
step 00019/00040 (47.50%) | loss: 8.109993 | lrm: 1.00 | dt: 878.91ms | tok/sec: 1,165 | mfu: 0.11 | total time: 0.13m
Step 00020 | Validation bpb: 2.4805
<|bos|>The capital of France is the the the the the the the the the the the the the the the the
<|bos|>The chemical symbol of gold is the the the the the the the the the the the the the the the the
<|bos|>If yesterday was Friday, then tomorrow will be the, the the the, the the the the the the the the the,
<|bos|>The opposite of hot is the, the, the the the, the the the the the the the the
<|bos|>The planets of the solar system are:, the the the the the the the the the the the the the the the
<|bos|>My favorite color is the the the, the, the, the, the, the, the,
<|bos|>If 5*x + 3 = 13, then x is the the the the the the the the the the the the the the the the
step 00020/00040 (50.00%) | loss: 8.129336 | lrm: 1.00 | dt: 840.25ms | tok/sec: 1,218 | mfu: 0.11 | total time: 0.14m
step 00021/00040 (52.50%) | loss: 8.130658 | lrm: 1.00 | dt: 845.67ms | tok/sec: 1,210 | mfu: 0.11 | total time: 0.16m
step 00022/00040 (55.00%) | loss: 8.086708 | lrm: 1.00 | dt: 844.45ms | tok/sec: 1,212 | mfu: 0.11 | total time: 0.17m
step 00023/00040 (57.50%) | loss: 8.028479 | lrm: 1.00 | dt: 884.36ms | tok/sec: 1,157 | mfu: 0.11 | total time: 0.19m
step 00024/00040 (60.00%) | loss: 8.025745 | lrm: 1.00 | dt: 847.66ms | tok/sec: 1,208 | mfu: 0.11 | total time: 0.20m
step 00025/00040 (62.50%) | loss: 7.965884 | lrm: 1.00 | dt: 846.41ms | tok/sec: 1,209 | mfu: 0.11 | total time: 0.21m
step 00026/00040 (65.00%) | loss: 7.908303 | lrm: 1.00 | dt: 936.70ms | tok/sec: 1,093 | mfu: 0.10 | total time: 0.23m
step 00027/00040 (67.50%) | loss: 7.904228 | lrm: 1.00 | dt: 850.78ms | tok/sec: 1,203 | mfu: 0.11 | total time: 0.24m
step 00028/00040 (70.00%) | loss: 7.906943 | lrm: 1.00 | dt: 847.74ms | tok/sec: 1,207 | mfu: 0.11 | total time: 0.26m
step 00029/00040 (72.50%) | loss: 7.903900 | lrm: 1.00 | dt: 845.89ms | tok/sec: 1,210 | mfu: 0.11 | total time: 0.27m
Step 00030 | Validation bpb: 2.4645
<|bos|>The capital of France is,,,,,,,,,,,,,,,,
<|bos|>The chemical symbol of gold is,,,,,,,,,,,,,,,,
<|bos|>If yesterday was Friday, then tomorrow will be,,,,,,,,,,,,,,,,
<|bos|>The opposite of hot is,,,,,,,,,,,,,,,,
<|bos|>The planets of the solar system are:,,,,,,,,,,,,,,,,
<|bos|>My favorite color is,,,,,,,,,,,,,,,,
<|bos|>If 5*x + 3 = 13, then x is,,,,,,,,,,,,,,,,
step 00030/00040 (75.00%) | loss: 7.900040 | lrm: 1.00 | dt: 844.20ms | tok/sec: 1,212 | mfu: 0.11 | total time: 0.29m
step 00031/00040 (77.50%) | loss: 7.892640 | lrm: 1.00 | dt: 912.46ms | tok/sec: 1,122 | mfu: 0.10 | total time: 0.30m
step 00032/00040 (80.00%) | loss: 7.922960 | lrm: 1.00 | dt: 847.12ms | tok/sec: 1,208 | mfu: 0.11 | total time: 0.32m
step 00033/00040 (82.50%) | loss: 7.924121 | lrm: 0.88 | dt: 845.60ms | tok/sec: 1,210 | mfu: 0.11 | total time: 0.33m
step 00034/00040 (85.00%) | loss: 7.893891 | lrm: 0.75 | dt: 845.94ms | tok/sec: 1,210 | mfu: 0.11 | total time: 0.34m
step 00035/00040 (87.50%) | loss: 7.912667 | lrm: 0.62 | dt: 913.35ms | tok/sec: 1,121 | mfu: 0.10 | total time: 0.36m
step 00036/00040 (90.00%) | loss: 7.901439 | lrm: 0.50 | dt: 850.08ms | tok/sec: 1,204 | mfu: 0.11 | total time: 0.37m
step 00037/00040 (92.50%) | loss: 7.870791 | lrm: 0.38 | dt: 847.36ms | tok/sec: 1,208 | mfu: 0.11 | total time: 0.39m
step 00038/00040 (95.00%) | loss: 7.838548 | lrm: 0.25 | dt: 846.34ms | tok/sec: 1,209 | mfu: 0.11 | total time: 0.40m
step 00039/00040 (97.50%) | loss: 7.820074 | lrm: 0.12 | dt: 847.98ms | tok/sec: 1,207 | mfu: 0.11 | total time: 0.42m
Step 00040 | Validation bpb: 2.4340
‚ö†Ô∏è  Skipping CORE eval (eval_bundle not found): [Errno 2] No such file or directory: '/content/drive/MyDrive/nanochat_colab/cache/eval_bundle/core.yaml'
Step 00040 | CORE metric: 0.0000
<|bos|>The capital of France is,,,,,,,,,,,,,,,,
<|bos|>The chemical symbol of gold is,,,,,,,,,,,,,,,,
<|bos|>If yesterday was Friday, then tomorrow will be the,,,,,,,,,,,,,,,
<|bos|>The opposite of hot is,,,,,,,,,,,,,,,,
<|bos|>The planets of the solar system are: the,,,,,,,,,,,,,,,
<|bos|>My favorite color is,,,,,,,,,,,,,,,,
<|bos|>If 5*x + 3 = 13, then x is,,,,,,,,,,,,,,,,
2025-10-19 10:16:22,573 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved model file to: /content/drive/MyDrive/nanochat_colab/cache/base_checkpoints/d2/model_000040.pt
2025-10-19 10:16:22,710 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved optimizer file to: /content/drive/MyDrive/nanochat_colab/cache/base_checkpoints/d2/optim_000040.pt
2025-10-19 10:16:22,718 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved metadata file to: /content/drive/MyDrive/nanochat_colab/cache/base_checkpoints/d2/meta_000040.json
Peak memory usage: 584.00MiB
Total training time: 0.42m
Minimum validation bpb: 2.4340
